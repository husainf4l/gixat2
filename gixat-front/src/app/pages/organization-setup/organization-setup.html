<div class="min-h-screen bg-gradient-to-br from-slate-50 via-white to-slate-50">
  <div class="max-w-5xl mx-auto px-6 py-8">
    <!-- Main Card -->
    <div class="bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden">
      
      <!-- Tabs -->
      <div class="flex p-1.5 bg-slate-50 m-6 rounded-xl">
      <button 
        (click)="setTab('create')"
        [class.bg-white]="activeTab() === 'create'"
        [class.shadow-sm]="activeTab() === 'create'"
        [class.text-slate-900]="activeTab() === 'create'"
        [class.text-slate-500]="activeTab() === 'create'"
        class="flex-1 py-2 text-[13px] font-medium rounded-lg transition-all duration-300"
      >
        Create Company
      </button>
      <button 
        (click)="setTab('join')"
        [class.bg-white]="activeTab() === 'join'"
        [class.shadow-sm]="activeTab() === 'join'"
        [class.text-slate-900]="activeTab() === 'join'"
        [class.text-slate-500]="activeTab() === 'join'"
        class="flex-1 py-2 text-[13px] font-medium rounded-lg transition-all duration-300"
      >
        Join with Code
      </button>
    </div>

    <div class="px-10 pb-10">
      <!-- Create Form -->
      @if (activeTab() === 'create') {
        <div class="animate-in fade-in slide-in-from-right-4 duration-500">
          <h2 class="text-xl font-semibold text-slate-900 tracking-tight mb-2">Set up your company</h2>
          <p class="text-sm text-slate-500 mb-6 leading-relaxed">Enter your organization details to get started with Gixat.</p>

          @if (errorMessage()) {
            <div class="mb-6 p-4 bg-red-50 border border-red-100 rounded-xl text-red-600 text-sm font-medium animate-in fade-in slide-in-from-top-2 duration-200">
              {{ errorMessage() }}
            </div>
          }

          <form [formGroup]="createForm" (ngSubmit)="onCreateSubmit()" class="space-y-5">
            <div>
              <label class="block text-[12px] font-medium text-[#86868b] mb-1.5 ml-1">Company Name</label>
              <input 
                type="text" 
                formControlName="name"
                placeholder="e.g. Acme Corp"
                class="w-full px-4 py-3 bg-[#f5f5f7] border-transparent rounded-xl text-[15px] focus:bg-white focus:ring-2 focus:ring-brand/20 focus:border-brand transition-all outline-none placeholder:text-[#d2d2d7]"
              >
            </div>

            <div class="grid grid-cols-2 gap-4">
              <div>
                <label class="block text-[12px] font-medium text-[#86868b] mb-1.5 ml-1">Country</label>
                <select 
                  formControlName="country"
                  class="w-full px-4 py-3 bg-[#f5f5f7] border-transparent rounded-xl text-[15px] focus:bg-white focus:ring-2 focus:ring-brand/20 focus:border-brand transition-all outline-none appearance-none cursor-pointer"
                >
                  <option value="" disabled selected>Select a country</option>
                  @for (country of countries(); track country.id) {
                    <option [value]="country.country">{{ country.country }}</option>
                  }
                </select>
              </div>
              <div>
                <label class="block text-[12px] font-medium text-[#86868b] mb-1.5 ml-1">City</label>
                <select 
                  formControlName="city"
                  [disabled]="!createForm.get('country')?.value || availableCities().length === 0"
                  class="w-full px-4 py-3 bg-[#f5f5f7] border-transparent rounded-xl text-[15px] focus:bg-white focus:ring-2 focus:ring-brand/20 focus:border-brand transition-all outline-none appearance-none cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed"
                >
                  <option value="" disabled selected>
                    {{ createForm.get('country')?.value ? 'Select a city' : 'Select country first' }}
                  </option>
                  @for (city of availableCities(); track city.id) {
                    <option [value]="city.city">{{ city.city }}</option>
                  }
                </select>
              </div>
            </div>

            <div>
              <label class="block text-[12px] font-medium text-[#86868b] mb-1.5 ml-1">Street Address</label>
              <input 
                type="text" 
                formControlName="street"
                placeholder="e.g. 123 Main St"
                class="w-full px-4 py-3 bg-[#f5f5f7] border-transparent rounded-xl text-[15px] focus:bg-white focus:ring-2 focus:ring-brand/20 focus:border-brand transition-all outline-none placeholder:text-[#d2d2d7]"
              >
            </div>

            <div class="grid grid-cols-3 gap-4">
              <div>
                <label class="block text-[12px] font-medium text-[#86868b] mb-1.5 ml-1">Code</label>
                <input 
                  type="text" 
                  formControlName="phoneCountryCode"
                  placeholder="+970"
                  class="w-full px-4 py-3 bg-[#f5f5f7] border-transparent rounded-xl text-[15px] focus:bg-white focus:ring-2 focus:ring-brand/20 focus:border-brand transition-all outline-none placeholder:text-[#d2d2d7]"
                >
              </div>
              <div class="col-span-2">
                <label class="block text-[12px] font-medium text-[#86868b] mb-1.5 ml-1">
                  Phone Number
                  @if (phoneNumberLength()) {
                    <span class="text-brand">({{ phoneNumberLength() }} digits)</span>
                  }
                </label>
                <input 
                  type="tel" 
                  formControlName="phoneNumber"
                  [placeholder]="phoneNumberLength() ? '0' + '0'.repeat(phoneNumberLength()! - 1) : 'e.g. 599123456'"
                  [maxlength]="phoneNumberLength() || 15"
                  class="w-full px-4 py-3 bg-[#f5f5f7] border-transparent rounded-xl text-[15px] focus:bg-white focus:ring-2 focus:ring-brand/20 focus:border-brand transition-all outline-none placeholder:text-[#d2d2d7]"
                >
                @if (createForm.get('phoneNumber')?.invalid && createForm.get('phoneNumber')?.touched) {
                  <p class="text-[11px] text-red-500 mt-1.5 ml-1">
                    @if (phoneNumberLength()) {
                      Must be exactly {{ phoneNumberLength() }} digits
                    } @else {
                      Please enter a valid phone number
                    }
                  </p>
                }
              </div>
            </div>
            
            @if (selectedCountryMetadata()) {
              <p class="text-[11px] text-[#86868b] -mt-2 ml-1">
                Phone code auto-filled for {{ createForm.get('country')?.value }}, but you can edit it if needed
              </p>
            }

            <button 
              type="submit"
              [disabled]="createForm.invalid || isLoading()"
              class="w-full mt-4 py-3.5 bg-brand text-white rounded-full text-[15px] font-semibold hover:bg-brand-hover active:scale-[0.98] transition-all disabled:opacity-50 disabled:pointer-events-none flex items-center justify-center gap-2"
            >
              @if (isLoading()) {
                <div class="w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"></div>
              }
              Create Organization
            </button>
          </form>
        </div>
      }

      <!-- Join Form -->
      @if (activeTab() === 'join') {
        <div class="animate-in fade-in slide-in-from-left-4 duration-500">
          <h2 class="text-xl font-semibold text-slate-900 tracking-tight mb-2">Join an organization</h2>
          <p class="text-sm text-slate-500 mb-6 leading-relaxed">Enter the 8-character invitation code provided by your administrator.</p>

          @if (errorMessage()) {
            <div class="mb-6 p-4 bg-red-50 border border-red-100 rounded-xl text-red-600 text-sm font-medium animate-in fade-in slide-in-from-top-2 duration-200">
              {{ errorMessage() }}
            </div>
          }

          <form [formGroup]="joinForm" (ngSubmit)="onJoinSubmit()" class="space-y-6">
            <div>
              <label class="block text-[12px] font-medium text-[#86868b] mb-1.5 ml-1 text-center">Invitation Code</label>
              <input 
                type="text" 
                formControlName="inviteCode"
                placeholder="XXXX-XXXX"
                maxlength="8"
                class="w-full px-4 py-5 bg-[#f5f5f7] border-transparent rounded-2xl text-[28px] font-mono tracking-[0.5em] text-center focus:bg-white focus:ring-2 focus:ring-brand/20 focus:border-brand transition-all outline-none placeholder:text-[#d2d2d7] uppercase"
              >
            </div>

            <button 
              type="submit"
              [disabled]="joinForm.invalid || isLoading()"
              class="w-full py-3.5 bg-[#1d1d1f] text-white rounded-full text-[15px] font-semibold hover:bg-black active:scale-[0.98] transition-all disabled:opacity-50 disabled:pointer-events-none flex items-center justify-center gap-2"
            >
              @if (isLoading()) {
                <div class="w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"></div>
              }
              Connect to Company
            </button>
          </form>

          <div class="mt-8 p-4 bg-[#f5f5f7] rounded-2xl border border-[#d2d2d7]/30">
            <div class="flex gap-3">
              <i class="ri-information-line text-[#86868b] text-lg"></i>
              <p class="text-[13px] text-[#86868b] leading-snug">
                Can't find your code? Check your email or ask your team administrator for a new invitation.
              </p>
            </div>
          </div>
        </div>
      }
    </div>
  </div>

  <!-- Footer -->
  <div class="mt-10 flex items-center gap-6 animate-in fade-in duration-1000 delay-500">
    <a href="#" class="text-[12px] text-[#86868b] hover:text-brand transition-colors">Privacy Policy</a>
    <span class="w-1 h-1 bg-[#d2d2d7] rounded-full"></span>
    <a href="#" class="text-[12px] text-[#86868b] hover:text-brand transition-colors">Terms of Service</a>
    <span class="w-1 h-1 bg-[#d2d2d7] rounded-full"></span>
    <a href="#" class="text-[12px] text-[#86868b] hover:text-brand transition-colors">Contact Support</a>
  </div>
</div>
